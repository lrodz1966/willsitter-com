<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Simple QR Scanner</title>
    <script src="https://unpkg.com/html5-qrcode"></script>
    <style>
      body { font-family: sans-serif; text-align: center; padding-top: 20px; }
      #reader { width: 300px; margin: auto; }
      #output { margin-top: 20px; font-size: 18px; font-weight: bold; }
    </style>
  </head>
  <body>
    <h2>Simple QR Scanner</h2>
    <div id="reader"></div>
    <div id="output">Scan a QR code...</div>

    <script>
      const qrRegion = document.getElementById("reader");
      const output = document.getElementById("output");

      const html5QrCode = new Html5Qrcode("reader");

      Html5Qrcode.getCameras().then(devices => {
        if (devices && devices.length > 0) {
          const cameraId = devices[0].id;
         html5QrCode.start(
          cameraId,
          { fps: 10, qrbox: { width: 250, height: 250 } },
          (decodedText) => {
            console.log("üì¶ QR code decoded:", decodedText);
            // üëá This sends the scanned result back to the HTML component in Wix
            window.parent.postMessage({ qrCode: decodedText }, "*");
          },
          (errorMessage) => {
            // ignore errors
          }
        )
        .catch(err => {
            output.textContent = "‚ùå Error starting scanner: " + err;
          });
        } else {
          output.textContent = "‚ùå No camera found.";
        }
      }).catch(err => {
        output.textContent = "‚ùå Camera access error: " + err;
      });
    </script>
  </body>
</html>

